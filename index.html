<!DOCTYPE html>
<html lang="sl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FURA - Isci/Nudi Prevoz</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/forms.css">
    <link rel="stylesheet" href="css/modals.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="stylesheet" href="css/datepicker.css">
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/sl.js"></script>

    <!-- Firebase SDK - Loading these in head to ensure they're available before any other scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    
    <!-- EmailJS for email sending -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

    <!-- Centralized Firebase Configuration -->
    <script src="js/firebase-config.js"></script>
    
    <!-- Translation System -->
    <script src="js/translations.js"></script>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <a href="index.html" class="logo">FURA</a>
                <div class="nav-right">
                    <!-- Language Selector -->
                    <div class="language-selector">
                        <div class="current-language" onclick="toggleLanguageDropdown()">
                            <span class="flag-icon" id="currentFlag">üá∏üáÆ</span>
                            <svg class="dropdown-arrow" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6 9 12 15 18 9"></polyline>
                            </svg>
                        </div>
                        <div class="language-dropdown" id="languageDropdown">
                            <div class="language-option" onclick="changeLanguage('sl')">
                                <span class="flag-icon">üá∏üáÆ</span>
                                <span>Sloven≈°ƒçina</span>
                            </div>
                            <div class="language-option" onclick="changeLanguage('en')">
                                <span class="flag-icon">üá¨üáß</span>
                                <span>English</span>
                            </div>
                            <div class="language-option" onclick="changeLanguage('sr')">
                                <span class="flag-icon">üá∑üá∏</span>
                                <span>–°—Ä–ø—Å–∫–∏</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="auth-buttons">
                        <a href="#" class="btn btn-outline" onclick="showLoginModal()" data-translate="login">Prijavi se</a>
                        <a href="#" class="btn btn-primary" onclick="showRegisterModal()" data-translate="register">Registracija</a>
                        <!-- Auth buttons for logged in users will be added by JavaScript -->
                    </div>
                </div>
            </nav>
        </div>
    </header>
    
    <main>
        <div class="container">
      <div id="initialLoadingScreen" class="initial-loading-overlay">
        <div class="loading-container">
            <div class="loading-logo">FURA</div>
            <div class="loading-spinner"></div>
            <div class="loading-text">Iskanje prevozov...</div>
        </div>
    </div>
        <div class="search-panel">
            <div class="ride-type-tabs">
                <div class="tab-btn active" data-tab="all" data-translate="allRides">Vse fure</div>
                <div class="tab-btn" data-tab="looking" data-translate="lookingForRide">I≈°ƒçem prevoz</div>
                <div class="tab-btn" data-tab="offering" data-translate="offeringRide">Nudim prevoz</div>
            </div>
            
            <div class="form-group">
                <div class="form-row">
                    <div class="form-col">
                        <div class="input-group">
                            <label class="input-label" data-translate="from">Iz</label>
                            <select class="input-field country-select" id="fromCountry" data-translate-placeholder="country">
                                <option value="" data-translate="selectCountry">Izberi dr≈æavo</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-col">
                        <div class="input-group">
                            <label class="input-label" data-translate="to">V</label>
                            <select class="input-field country-select" id="toCountry" data-translate-placeholder="country">
                                <option value="" data-translate="selectCountry">Izberi dr≈æavo</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="swap-container">
                    <div class="swap-btn" id="swapLocationsBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <!-- Promenjena ikonica za levo-desno umesto gore-dole -->
                            <path d="M16 3h5v5"></path>
                            <path d="M4 20l16-16"></path>
                            <path d="M3 16v5h5"></path>
                            <path d="M20 3l-16 16"></path>
                        </svg>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-col">
                        <div class="input-group">
                            <label class="input-label" data-translate="from">Iz</label>
                            <select class="input-field city-select" id="fromCity" data-translate-placeholder="city">
                                <option value="" data-translate="selectCity">Izberi mesto</option>
                            </select>
                        </div>
                    </div>

                

                    <div class="form-col">
                        <div class="input-group">
                            <label class="input-label" data-translate="to">V</label>
                            <select class="input-field city-select" id="toCity" data-translate-placeholder="city">
                                <option value="" data-translate="selectCity">Izberi mesto</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Date picker with date-only option -->
              
<div class="date-picker-container">
  <button type="button" class="date-picker-button" id="dateTimePicker">
      <span class="calendar-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="16" y1="2" x2="16" y2="6"></line>
              <line x1="8" y1="2" x2="8" y2="6"></line>
              <line x1="3" y1="10" x2="21" y2="10"></line>
          </svg>
      </span>
      <span class="date-text" data-translate="dateTime">Datum in ura</span>
  </button>
  <div class="date-only-option">
      <label class="checkbox-container">
          <span data-translate="dateOnly">Brez ure</span>
          <input type="checkbox" id="dateOnlyCheckbox" class="date-only-checkbox">
          <span class="checkmark"></span>
      </label>
  </div>
</div>
                
                <div class="search-buttons">
                    <button class="btn btn-accent search-btn" data-translate="searchRide">Poi≈°ƒçi prevoz</button>
                    <button class="btn btn-outline reset-btn" id="resetFiltersBtn" data-translate="resetFilters">Ponastavi filtre</button>
                </div>
            </div>
            
            <div class="advanced-search">
                <button class="advanced-search-btn" id="advancedSearchBtn">
                    <span data-translate="advancedSearch">Napredno iskanje</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
                
                <div class="advanced-filters" id="advancedFilters">
                    <div class="form-row">
                        <div class="form-col">
                            <div class="input-group">
                                <label class="input-label" data-translate="vehicleType">Prevozno sredstvo</label>
                                <select class="input-field" id="vehicleTypeFilter">
                                    <option value="" data-translate="allVehicleTypes">Vse vrste vozil</option>
                                    <option value="avtotransporter" data-translate="avtotransporter">Avtotransporter</option>
                                    <option value="avtovleka" data-translate="avtovleka">Avtovleka</option>
                                    <option value="furgon" data-translate="furgon">Furgon</option>
                                    <option value="kombi" data-translate="kombi">Kombi</option>
                                    <option value="vlaƒçilec" data-translate="vlaƒçilec">Vlaƒçilec</option>
                                    <option value="truck" data-translate="truck">Tovornjak</option>
                                    <option value="van" data-translate="van">Kombi/Van</option>
                                    <option value="other" data-translate="other">Drugo</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="input-group">
                                <label class="input-label" data-translate="dimensions">Dimenzije</label>
                                <select class="input-field" id="vehicleSizeFilter">
                                    <option value="" data-translate="allDimensions">Vse dimenzije</option>
                                    <option value="small" data-translate="smallVehicle">Majhno vozilo</option>
                                    <option value="medium" data-translate="mediumVehicle">Srednje vozilo</option>
                                    <option value="large" data-translate="largeVehicle">Veliko vozilo</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="refrigerated">
                        <label for="refrigerated" data-translate="refrigeratedOnly">Samo vozila s hladilnikom</label>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="results-section">
            <div class="results-header">
                <div class="results-count" id="resultsCount"></div>
                </div>
            </div>
            
            <table class="results-table">
                <thead>
                    <tr>
                        <th data-translate="fromLocation">OD</th>
                        <th data-translate="toLocation">DO</th>
                        <th data-translate="date">DATUM</th>
                        <th data-translate="time">URA</th>
                        <th data-translate="vehicle">VRSTA VOZILA</th>
                        <th data-translate="rideType">TIP FURE</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Results will be dynamically loaded here by JavaScript -->
                </tbody>
            </table>
        </div>
    </main>
    
    <!-- Ride Details Modal -->
    <div class="modal" id="rideDetailsModal">
        <div class="modal-content">
            <div class="modal-body">
                <h3 class="modal-title" data-translate="rideDetailsTitle">Informacije o prevozu</h3>
                
                <div class="detail-row">
                    <div class="detail-label"></div>
                    <div class="detail-value"></div>
                </div>
                
                <div class="detail-row">
                    <div class="detail-label"></div>
                    <div class="detail-value"></div>
                </div>
                
                <div class="detail-row">
                    <div class="detail-label"></div>
                    <div class="detail-value"></div>
                </div>
                
                <div class="detail-row">
                    <div class="detail-label"></div>
                    <div class="detail-value"></div>
                </div>
                
                <div class="detail-row">
                    <div class="detail-label"></div>
                    <div class="detail-value"></div>
                </div>
                
                <div class="detail-row">
                    <div class="detail-label"></div>
                    <div class="detail-value"></div>
                </div>
                
                <div class="detail-row">
                    <div class="detail-label"></div>
                    <div class="detail-value"></div>
                </div>
                
                <div class="detail-row">
                    <div class="detail-label"></div>
                    <div class="detail-value" id="ridePriceValue"></div>
                </div>
                
                <div class="detail-row">
                    <div class="detail-label"></div>
                    <div class="detail-value">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="closeModal('rideDetailsModal')" data-translate="close">Zapri</button>
                <button class="btn btn-accent" data-translate="contactOwner">Kontaktiraj</button>
            </div>
        </div>
    </div>
    
    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-close" onclick="closeModal('loginModal')">‚úï</div>
            </div>
            <div class="modal-body">
                <div class="form-container" style="margin: 0; box-shadow: none; padding: 0;">
                    <h2 class="form-title" data-translate="loginTitle">Prijava</h2>
                    
                    <div class="input-group">
                        <label class="input-label" data-translate="emailOrUsername">Email ali uporabni≈°ko ime</label>
                        <input type="email" class="input-field" id="loginEmail" data-translate-placeholder="emailOrUsername" placeholder="Vnesite email ali uporabni≈°ko ime">
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label" data-translate="password">Geslo</label>
                        <input type="password" class="input-field" id="loginPassword" data-translate-placeholder="password" placeholder="Vnesite geslo">
                    </div>
                    
                    <button class="btn btn-primary search-btn" id="loginButton" data-translate="loginButton">Prijava</button>
                    
                    <div class="form-footer">
                        <p><span data-translate="noAccount">Nimate raƒçuna?</span> <a href="#" onclick="showRegisterModal()" data-translate="registerLink">Registrirajte se</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Register Modal -->
    <div class="modal" id="registerModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-close" onclick="closeModal('registerModal')">‚úï</div>
            </div>
            <div class="modal-body">
                <div class="form-container" style="margin: 0; box-shadow: none; padding: 0;">
                    <h2 class="form-title" data-translate="registerTitle">Registracija</h2>
                    
                    <div class="form-row">
                        <div class="form-col">
                            <div class="input-group">
                                <label class="input-label" data-translate="firstName">Ime</label>
                                <input type="text" class="input-field" id="registerFirstName" data-translate-placeholder="firstName" placeholder="Vnesite ime">
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="input-group">
                                <label class="input-label" data-translate="lastName">Priimek</label>
                                <input type="text" class="input-field" id="registerLastName" data-translate-placeholder="lastName" placeholder="Vnesite priimek">
                            </div>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label" data-translate="email">Email</label>
                        <input type="email" class="input-field" id="registerEmail" data-translate-placeholder="email" placeholder="Vnesite email">
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label" data-translate="username">Uporabni≈°ko ime</label>
                        <input type="text" class="input-field" id="registerUsername" data-translate-placeholder="username" placeholder="Vnesite uporabni≈°ko ime">
                    </div>

                    <!-- Add this after the Username field and before the Password field -->
<div class="input-group phone-input-group">
  <label class="input-label" data-translate="phone">Telefon</label>
  <div class="phone-input-container">
    <div class="country-code-selector">
      <div class="selected-country">
        <span class="country-flag">üá∏üáÆ</span>
        <span class="country-code">+386</span>
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </div>
      <div class="country-dropdown">
        <div class="country-search">
          <input type="text" placeholder="Iskanje..." id="countrySearchInput">
        </div>
        <div class="country-list">
          <!-- Country options will be added dynamically -->
        </div>
      </div>
    </div>
    <input type="tel" class="input-field phone-number" id="registerPhone" data-translate-placeholder="enterPhoneNumber" placeholder="Vnesite telefonsko ≈°tevilko">
    <input type="hidden" id="fullPhoneNumber">
  </div>
</div>
                    
                    <div class="input-group">
                        <label class="input-label" data-translate="password">Geslo</label>
                        <input type="password" class="input-field" id="registerPassword" data-translate-placeholder="password" placeholder="Vnesite geslo">
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label" data-translate="confirmPassword">Potrdite geslo</label>
                        <input type="password" class="input-field" id="registerConfirmPassword" data-translate-placeholder="confirmPassword" placeholder="Ponovno vnesite geslo">
                    </div>

                    
                    
                    <button class="btn btn-primary search-btn" id="registerButton" data-translate="registerButton">Registracija</button>
                    
                    <div class="form-footer">
                        <p><span data-translate="haveAccount">≈Ωe imate raƒçun?</span> <a href="#" onclick="showLoginModal()" data-translate="loginLink">Prijavite se</a></p>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </main>
    
    <!-- Footer -->
    <footer class="site-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>FURA</h3>
                    <p data-translate="footerDescription">Platforma za iskanje in nudenje prevozov po Sloveniji in sosednjih dr≈æavah.</p>
                </div>
                
                <div class="footer-section">
                    <h4 data-translate="legalTitle">Pravne informacije</h4>
                    <ul class="footer-links">
                        <li><a href="pages/privacy-policy.html" data-translate="privacyPolicy">Pravilnik o zasebnosti</a></li>
                        <li><a href="pages/terms-conditions.html" data-translate="termsConditions">Splo≈°ni pogoji</a></li>
                        <li><a href="pages/about.html" data-translate="about">O nas</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 FURA. <span data-translate="allRightsReserved">Vse pravice pridr≈æane.</span></p>
            </div>
        </div>
    </footer>
    
<!-- Include JavaScript files -->
<!-- IMPORTANT: Loading order matters for dependencies -->
<script src="js/vehicle-dimensions.js"></script>
<script src="js/location-data.js"></script> <!-- Nova datoteka -->
<script src="js/firestore-rides.js"></script>
<script src="js/auth.js"></script>
<script src="js/utils.js"></script>
<script src="js/modals.js"></script>
<script src="js/main.js"></script>
<script src="js/search.js"></script>
<script src="js/dropdown-locations.js"></script>
<script src="js/datepicker.js"></script>
<script src="js/phone-input.js"></script>

    <!-- Auth helpers and UI update functions -->
    <script>
      // Authentication functions are now handled in auth.js
      // This section contains only UI-specific functions
      // Funkcija za formatiranje cene
function formatPrice(priceInfo) {
  if (!priceInfo) return window.t ? window.t('free') : 'Besplatno';
  
  switch(priceInfo.type) {
    case 'free':
      return window.t ? window.t('free') : 'Besplatno';
    case 'negotiable':
      return window.t ? window.t('negotiable') : 'Po dogovoru';
    case 'fixed':
      if (priceInfo.amount && priceInfo.currency) {
        // Formatiramo cenu sa dve decimale
        const amount = parseFloat(priceInfo.amount).toFixed(2);
        
        // Razliƒçiti prikazi za razliƒçite valute
        switch(priceInfo.currency) {
          case 'EUR':
            return `${amount} ‚Ç¨`;
          case 'BAM':
            return `${amount} KM`;
          case 'RSD':
            return `${amount} RSD`;
          case 'HRK':
            return `${amount} HRK`;
          case 'MKD':
            return `${amount} MKD`;
          case 'ALL':
            return `${amount} ALL`;
          default:
            return `${amount} ${priceInfo.currency}`;
        }
      } else {
        return window.t ? window.t('fixedPrice') : 'Fiksna cena';
      }
    default:
      return window.t ? window.t('free') : 'Besplatno';
  }
}


// Uklonite postojeƒái loading screen kod i zamijenite ga ovim
let globalLoadingTimeout;

document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM loaded, setting up loading screen logic');
    const loadingScreen = document.getElementById('initialLoadingScreen');
    
    // Funkcija za uklanjanje loading screena
    function hideLoadingScreen() {
        console.log('Hiding loading screen');
        if (loadingScreen) {
            loadingScreen.classList.add('fade-out');
            
            setTimeout(() => {
                if (loadingScreen && loadingScreen.parentNode) {
                    loadingScreen.parentNode.removeChild(loadingScreen);
                    console.log('Loading screen removed from DOM');
                }
            }, 300);
        }
        
        if (globalLoadingTimeout) {
            clearTimeout(globalLoadingTimeout);
            globalLoadingTimeout = null;
        }
    }
    
    // Maksimalno vrijeme ƒçekanja - 15 sekundi
    globalLoadingTimeout = setTimeout(hideLoadingScreen, 15000);
    
    // Inicijalno ƒáemo postaviti updateAuthUI funkciju ako nije definirana
    if (typeof window.updateAuthUI !== 'function') {
        window.updateAuthUI = function() {
            console.log('Default updateAuthUI called');
        };
    }
    
    // Dodajte ovaj kod za rje≈°avanje problema s dozvolama Firestore-a
    const errorHandler = function(error) {
        console.error('Firestore error:', error);
        if (error && error.code === 'permission-denied') {
            // Poku≈°ajte ponovno uƒçitati podatke nakon autentifikacije
            console.log('Permission denied, will retry after authentication');
        }
    };
    
    // Koristite samo jedan onAuthStateChanged event
    firebase.auth().onAuthStateChanged(function(user) {
        console.log('Auth state resolved:', user ? 'User logged in' : 'User not logged in');
        
        if (user) {
            console.log('User is authenticated:', user.email);
            // A≈æurirajte UI za prijavljenog korisnika
            updateUIAfterLogin(user);
            
            // Pristupite podacima nakon uspje≈°ne autentifikacije
            try {
                // Kratka odgoda prije pristupanja Firestore-u
                setTimeout(() => {
                    loadInitialResults().catch(errorHandler);
                }, 1000);
            } catch (err) {
                errorHandler(err);
            }
        } else {
            // Poku≈°ajte dohvatiti javno dostupne podatke
            console.log('User not authenticated, attempting to load public data');
            loadInitialResults().catch(errorHandler);
        }
        
        // Sakrij loading screen nakon odgode
        setTimeout(hideLoadingScreen, 1000);
    });
});
  
    </script>

    <!-- Added script for handling time display in search results -->
    <script>
      // Override the displayRideResults function to show "Prilagodljivo" for rides without time
      window.displayOriginalRideResults = window.displayRideResults;
      
      window.displayRideResults = function(rides) {
        // Store results for re-translation when language changes
        if (typeof storeSearchResults === 'function') {
          storeSearchResults(rides);
        }
        
        // Get the results container
        const resultsTable = document.querySelector('.results-table tbody');
        if (!resultsTable) return;
        
        // Clear previous results
        resultsTable.innerHTML = '';
        
        // Update results count
        document.querySelector('.results-count').textContent = `Prikazujem ${rides.length} prevozov`;
        
        // Get current user ID for identifying own rides
        const currentUser = firebase.auth().currentUser;
        const currentUserId = currentUser ? currentUser.uid : null;
        
        // Add each ride to the table
        rides.forEach(ride => {
          const tableRow = document.createElement('tr');
          
          // Check if this is user's own ride
          const isMyRide = currentUserId && ride.createdBy === currentUserId;
          
          // Add class based on ride type
          if (ride.type === 'offering') {
            tableRow.classList.add('offering-ride');
          } else {
            tableRow.classList.add('looking-ride');
          }
          
          // Add class for user's own rides
          if (isMyRide) {
            tableRow.classList.add('my-ride');
          }
          
          // Add click handler to show details
          tableRow.addEventListener('click', function() {
            showRideDetails(ride.id);
          });
          
          // Set ride type text and class
          const typeText = translateRideType(ride.type);
          const typeClass = ride.type === 'offering' ? 'offering' : 'looking';
          
          // Format time with "Prilagodljivo" for rides without time
          const timeDisplay = ride.formattedTime || ride.displayTime || translateFlexibleTime();
          
          // Create badge HTML including "Moja fura" badge if it's the user's ride
          let badgeHtml = `<div class="ride-type-badge ${typeClass}">${typeText}</div>`;
          if (isMyRide) {
            badgeHtml += `<span class="my-ride-badge">Moja fura</span>`;
          }
          
          // Populate the row
          tableRow.innerHTML = `
            <td>${ride.fromCity}, ${ride.fromCountry}</td>
            <td>${ride.toCity}, ${ride.toCountry}</td>
            <td>${ride.formattedDate || ride.displayDate || 'Ni datuma'}</td>
            <td>${timeDisplay}</td>
            <td>${ride.vehicleTypeDisplay || ride.vehicleType}</td>
            <td>${badgeHtml}</td>
          `;
          
          resultsTable.appendChild(tableRow);
        });
      };
    </script>

<!-- Custom styles for "My Rides" -->
<style>
  /* Adjusting search panel padding and compactness */
.search-panel {
  padding: 20px 30px; /* Reduced top/bottom padding and increased left/right padding */
}

.form-row {
  margin-bottom: 15px; /* Reduced spacing between form rows */
}

.input-group {
  margin-bottom: 15px; /* Reduced margin for input groups */
}

.search-buttons {
  margin-top: 15px; /* Adjusted spacing before search buttons */
}

.date-picker-container {
  margin: 15px 0; /* Reduced margin around date picker */
}

.advanced-search {
  margin-top: 10px; /* Reduced margin before advanced search section */
}

/* Make form labels a bit more compact */
.input-label {
  top: 10px; /* Adjust label position */
}

.input-field {
  padding: 22px 15px 8px; /* Adjust padding to accommodate moved label */
}
  /* Styling for rides that belong to the current user */
  .my-ride {
    position: relative;
    border: 2px solid var(--primary-color) !important;
    background-color: rgba(92, 107, 192, 0.05) !important;
  }
  
  .my-ride:hover {
    background-color: rgba(92, 107, 192, 0.1) !important;
  }
  
  /* Enhanced styling for "Moja fura" badge - with smaller text */
  .my-ride-badge {
    display: inline-block;
    background: linear-gradient(135deg, var(--primary-color), #8c9eff);
    color: white;
    font-size: 0.65rem; /* Smaller text */
    font-weight: 600;
    letter-spacing: 0.2px;
    padding: 1px 5px;
    border-radius: 8px;
    margin-left: 5px;
    vertical-align: middle;
    box-shadow: 0 1px 3px rgba(92, 107, 192, 0.3);
    text-transform: uppercase;
    font-family: 'Segoe UI', Arial, sans-serif;
    animation: badge-pulse 2s infinite;
    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
  }

  /* Pulsing animation for the badge */
  @keyframes badge-pulse {
    0% {
      box-shadow: 0 0 0 0 rgba(92, 107, 192, 0.7);
    }
    70% {
      box-shadow: 0 0 0 3px rgba(92, 107, 192, 0);
    }
    100% {
      box-shadow: 0 0 0 0 rgba(92, 107, 192, 0);
    }
  }
  
  /* Specific border colors for different ride types */
  .offering-ride.my-ride {
    border-color: var(--primary-color) !important; /* Blue border for "Nudim prevoz" */
  }
  
  .looking-ride.my-ride {
    border-color: var(--accent-color) !important; /* Orange border for "Iscem prevoz" */
  }
  
  /* Style for the updated ride details modal buttons */
  .modal-footer {
    display: flex;
    gap: 10px;
    justify-content: flex-end;
    padding: 15px 20px 20px;
  }
  
  /* Make sure the buttons have consistent styling */
  .modal-footer .btn {
    padding: 8px 15px;
  }
</style>

    <!-- Custom script to enhance ride ownership detection -->
    <script>
      // Function to apply the new ride details handler
      document.addEventListener('DOMContentLoaded', function() {
        console.log('Setting up ride ownership detection');
        
        // Make sure to identify rides when they're loaded
        const originalUpdateSearchResults = window.updateSearchResults;
        if (typeof originalUpdateSearchResults === 'function') {
          window.updateSearchResults = function(results) {
            console.log('Enhanced updateSearchResults called');
            
            // Call the original function first
            originalUpdateSearchResults(results);
            
            // Then add extra highlighting for own rides
            highlightOwnRides();
          };
        }
        
        // Function to highlight own rides in the results
        function highlightOwnRides() {
          const currentUser = firebase.auth().currentUser;
          if (!currentUser) return;
          
          // Find rides that belong to current user and add a class
          const rides = document.querySelectorAll('.results-table tbody tr');
          rides.forEach(row => {
            // We've already added the class in the updateSearchResults function
            // This is just extra highlighting in case needed
            if (row.classList.contains('my-ride')) {
              // Can add extra visual styling here if needed
              console.log('Found and highlighted a user ride');
            }
          });
        }
      });
    </script>
</body>
</html>
